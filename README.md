# AI 활용 기반 복합 할인 실질 가치 분석 웹 애플리케이션

## 1. 프로젝트 개요
본 프로젝트는 **상품 자체 할인 + 금액대 프로모션 + 쿠폰 + 배송비(무료배송 조건)**을 함께 고려하여  
구매 전략(1회 결제 vs 2회 분할 결제) 중 **최종 결제 금액이 최소가 되는 전략**을 추천하는 웹 애플리케이션입니다.

단순히 “얼마 할인되는지”를 계산하는 것을 넘어, 다음 질문에 답하는 것을 목표로 합니다.

> **어떻게 구매하는 것이 가장 이득인가? (실질 가치/실질 할인율 기준)**

---

## 2. 문제 정의
사용자는 여러 상품과 쿠폰을 보유한 상황에서 다음과 같은 결정을 해야 합니다.

- 한 번에 구매할지 / 나눠 구매할지
- 어떤 쿠폰을 사용할지 (또는 쿠폰을 쓰지 않는 것이 나을지)
- 배송비/무료배송 조건까지 포함하면 어떤 전략이 유리한지

본 프로젝트는 위 조건을 반영하여 **전략별 최종 결제 금액**을 계산하고, 가장 유리한 전략을 도출합니다.

---

## 3. 핵심 기능
### ✅ 1회 결제 전략(1주문) 최적화
- 쿠폰 **미사용(null)** 포함
- 보유 쿠폰 중 **0~1개** 선택
- 최종 결제 금액이 최소인 조합 선택

### ✅ 2회 분할 전략(2주문) 완전 탐색
- 상품 라인 기준 분할 조합 탐색(최대 5개 → 2^N)
- 주문당 쿠폰 1장 사용 가능
- 동일 쿠폰 중복 사용 제한(정책)
- 배송비/무료배송 조건 주문별 반영

### ✅ 실질 절감/실질 할인율 산출
- 기준 결제 금액 대비 절감액 및 실질 할인율 계산
- 표시용 할인율은 소수점 둘째 자리까지 반올림

---

## 4. 계산 정책(핵심 규칙)

### 4.1 기준 결제 금액(Baseline)
전략 비교를 위한 기준 결제 금액은 다음과 같이 정의합니다.

- **상품 자체 할인 적용 후 금액**을 기준으로 잡고
- 해당 금액이 무료배송 조건을 충족하는지 판단한 뒤 배송비를 합산합니다.

즉,

> **쿠폰/프로모션/분할 전략을 사용하지 않았을 때의 실제 결제 금액**을 기준으로 절감액/할인율을 계산합니다.

---

### 4.2 할인 적용 파이프라인(주문 1건 기준)
주문 금액 계산은 아래 순서로 진행됩니다.

1) 상품 자체 할인  
2) 금액대 프로모션  
3) 쿠폰(최소 사용 금액 조건 및 캡 적용)  
4) 배송비(무료배송 조건 판정)  
5) 최종 결제 금액 산출

※ **프로모션 ↔ 쿠폰 적용 순서**는 옵션에 따라 변경 가능

---

### 4.3 금액 처리(절사/반올림)
- 금액 계산은 **원 단위 절사(버림)** 기준
- 표시용 할인율(savedRate)은 **소수점 둘째 자리 반올림**
- 할인 적용 후 금액이 0원 미만이 되는 경우 **0원으로 보정**
- 정률 할인 값은 **0~100%** 범위로 제한

---

## 5. 기술 스택
- Java 17
- Spring Boot
- Thymeleaf
- Maven

---

## 6. 프로젝트 구조(요약)
controller/
service/
domain/
form/

- Controller: 요청 수신/흐름 제어
- Service: 할인 계산 및 전략 탐색 로직(핵심)
- Domain: ProductItem, Coupon, DiscountResult 등 상태 보관
- Form: 사용자 입력 바인딩(DiscountForm)

모든 전략은 `DiscountCalculatorService`의 동일 계산 파이프라인(`calcOrder`)을 통해 수행됩니다.

---

## 7. 실행 방법
> ✅ 본 프로젝트는 **Eclipse(Boot Dashboard)** 환경에서 실행 검증을 완료했습니다.  
> 또한 심사 환경 재현성을 위해 **Maven Wrapper 실행 방법**도 함께 제공합니다.

### 표준: Maven Wrapper로 실행
**Mac / Linux**
```bash
./mvnw spring-boot:run

*Windows
mvnw.cmd spring-boot:run

브라우저 접속:
http://localhost:8080

Maven이 설치되어 있는 경우
mvn spring-boot:run

** Eclipse에서 실행(참고) **
 - Boot Dashboard → noaats-pretask 우클릭 → Start
 - Boot Dashboard → noaats-pretask 우클릭 → Open Web Browser
 또는
 - NoaatsPretaskApplication 우클릭 → Run As → Spring Boot App

---

## 8. 예외/경계 조건 처리(예시)
- 무료배송 기준 직전/직후 금액
- 쿠폰 최소 사용 금액 직전/직후 금액
- 할인 금액이 결제 금액을 초과하는 경우(0원 보정 + 배송비 판단)
- 분할 전략이 오히려 손해가 되는 경우
- 쿠폰 미사용이 최적이 될 수 있는 경우

---

## 9. 확장 가능성
- 3회 이상 분할 전략 확장
- 무료배송 기준 정책 옵션화(할인 전/후 기준 선택)
- 동일 쿠폰 다중 보유(수량) 처리 고도화
- 외부 쇼핑몰 API / DB 연동
- 추천 기준 다변화(최대 절감액, 최대 할인율, 최소 배송비 등)

